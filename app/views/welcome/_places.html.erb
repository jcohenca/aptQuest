
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">

<script>
  var map;
  var infowindow;
  var geocoder;
  var service;

  function initialize() {
    var currentLocation = new google.maps.LatLng(40.740289, -73.981314);
    
    geocoder = new google.maps.Geocoder();

    map = new google.maps.Map(document.getElementById('map-canvas'), {
      center: currentLocation,
      zoom: 15  ,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    infowindow = new google.maps.InfoWindow();
    service = new google.maps.places.PlacesService(map);
    findNearbyPlaces(currentLocation);
  }

  function findNearbyPlaces(searchLocation) {
    var request = {
      location: searchLocation,
      radius: 500,
      types: (['gym'])
    };
   service.nearbySearch(request, handleResults);

  }

  function handleResults(results, status) {
    if (status == google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        createMarker(results[i]);
      }
    }
  }


  function createMarker(place) {
    var placeLoc = place.geometry.location;
    var marker = new google.maps.Marker({
      map: map,
      title: place.name,
      animation: google.maps.Animation.DROP,
      position: place.geometry.location
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent(place.name);
      infowindow.open(map, this);
    });
  }

  function updateMapAddress() {
    var address = document.getElementById('address').value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        newLocation = results[0].geometry.location;
        map.setCenter(newLocation);
        
        var marker = new google.maps.Marker({
            map: map,
            animation: google.maps.Animation.DROP,
            position: newLocation,
        });
        
        findNearbyPlaces(newLocation);
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize);

</script>



